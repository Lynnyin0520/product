"use strict";(self.webpackChunkproduct_docs=self.webpackChunkproduct_docs||[]).push([[333],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>g});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),c=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},u=function(e){var t=c(e.components);return a.createElement(l.Provider,{value:t},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),p=c(n),m=r,g=p["".concat(l,".").concat(m)]||p[m]||d[m]||o;return n?a.createElement(g,s(s({ref:t},u),{},{components:n})):a.createElement(g,s({ref:t},u))}));function g(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,s=new Array(o);s[0]=m;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i[p]="string"==typeof e?e:r,s[1]=i;for(var c=2;c<o;c++)s[c]=n[c];return a.createElement.apply(null,s)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},1779:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>d,frontMatter:()=>o,metadata:()=>i,toc:()=>c});var a=n(7462),r=(n(7294),n(3905));const o={sidebar_label:"Golang",sidebar_position:2},s="GO SDK",i={unversionedId:"sdk/package/go",id:"sdk/package/go",title:"GO SDK",description:"1. Preparation",source:"@site/docs/sdk/package/go.md",sourceDirName:"sdk/package",slug:"/sdk/package/go",permalink:"/docs/sdk/package/go",draft:!1,editUrl:"https://github.com/uSpeedo/product/blob/main/docs/docs/sdk/package/go.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_label:"Golang",sidebar_position:2},sidebar:"sdk",previous:{title:"API Signature",permalink:"/docs/sdk/signature"}},l={},c=[{value:"1. Preparation",id:"1-preparation",level:2},{value:"1) Obtain API key information",id:"1-obtain-api-key-information",level:3},{value:"2) Apply for SMS template",id:"2-apply-for-sms-template",level:3},{value:"2. SDK",id:"2-sdk",level:2},{value:"1) Install using go get.",id:"1-install-using-go-get",level:3},{value:"2) Install using go mod",id:"2-install-using-go-mod",level:3},{value:"3) Parameter description",id:"3-parameter-description",level:3},{value:"4) Construct API signature",id:"4-construct-api-signature",level:3},{value:"3. Example",id:"3-example",level:2}],u={toc:c},p="wrapper";function d(e){let{components:t,...n}=e;return(0,r.kt)(p,(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"go-sdk"},"GO SDK"),(0,r.kt)("h2",{id:"1-preparation"},"1. Preparation"),(0,r.kt)("h3",{id:"1-obtain-api-key-information"},"1) Obtain API key information"),(0,r.kt)("p",null,"Before calling the API, you need to obtain the key information to generate the ",(0,r.kt)("inlineCode",{parentName:"p"},"X-Signature")," signature. You need to provide ",(0,r.kt)("inlineCode",{parentName:"p"},"AccessKeyId")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"AccessKeySecret"),", which can be obtained from the console account. For detailed steps on how to obtain them, please refer to: ",(0,r.kt)("a",{parentName:"p",href:"/docs/sdk/signature"},"How to obtain AccessKeyId and AccessKeySecret"),"."),(0,r.kt)("h3",{id:"2-apply-for-sms-template"},"2) Apply for SMS template"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://console.uspeedo.com/sms/template"},"How to apply for an SMS template")),(0,r.kt)("h2",{id:"2-sdk"},"2. SDK"),(0,r.kt)("h3",{id:"1-install-using-go-get"},"1) Install using go get."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-go"},"go get github.com/uSpeedo/usms-sdk-go\n")),(0,r.kt)("p",null,"Note: If you encounter unstable network, you can use a proxy server to speed up the download, such as using GOPROXY acceleration"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-go"},"export GOPROXY=https://goproxy.io\n")),(0,r.kt)("h3",{id:"2-install-using-go-mod"},"2) Install using go mod"),(0,r.kt)("p",null,"Importing SDK"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-go"},'import _ "github.com/uSpeedo/usms-sdk-go"\n\n')),(0,r.kt)("p",null,"Afterwards, execute it in the project root directory:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-go"},"go mod init\ngo mod tidy\n")),(0,r.kt)("h3",{id:"3-parameter-description"},"3) Parameter description"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Phone number list (PhoneNumbers): supports international and domestic SMS, international SMS uses the format (86)13812345678, and the international telephone area code needs to be added in front of the phone number."),(0,r.kt)("li",{parentName:"ul"},"SMS template ID (TemplateId): For first-time use, you need to apply for a template in the UCloud console. After the template is approved, pass the template ID to this location. "),(0,r.kt)("li",{parentName:"ul"},"SMS template parameter list (TemplateParams): The variables that can be passed in the SMS template. If there are several variables in the template when applying, you need to pass in several. "),(0,r.kt)("li",{parentName:"ul"},"SMS signature (SigContent): For first-time use, you need to apply for a signature in the UCloud console. After the signature is approved, pass the signature to this location. When there is a default signature, this parameter can be left blank.")),(0,r.kt)("h3",{id:"4-construct-api-signature"},"4) Construct API signature"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"The signature generator first puts all parameters and values into a map and sorts them in ascending order by key value. Then concatenate all parameters to form the signature text. Finally, sign the signature text using SHA1. If the interface requires uploading requests such as pictures/videos, the file stream does not participate in the signature. Please convert the file to a file stream format and request it in file stream format.")),(0,r.kt)("p",null,"1) Obtain AccessKeySecret from console account"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},"MjI3YmYyMjItNmM4Mi00ZGM5LWEwNDQtN2EzZjM0Yzk2OWE1\n")),(0,r.kt)("p",null,"2) Get the request body of the request and sort it in ascending order of ASCII code of the first character of each key (ascending order of letters). If the same character is encountered, sort it in ascending order of ASCII code of the second character, and so on."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "Action"     :  "SendBatchUSMSMessage",\n    "Limit"      :  10,\n    "Region"     :  "cn-bj2"\n}\n')),(0,r.kt)("p",null,'3) Combine the sorted parameters with their corresponding values in the format of "parameter=value", and concatenate "AccessKeySecret" at the end of this signature string. The resulting string is the string to be signed.'),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"ActionSendBatchUSMSMessageLimit10Regioncn-bj2MjI3YmYyMjItNmM4Mi00ZGM5LWEwNDQtN2EzZjM0Yzk2OWE1\n")),(0,r.kt)("p",null,"4) Calculate the signature value"),(0,r.kt)("p",null,"Use SHA1 to encode the string to be signed and generate the request signature."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"575fd93b539c4eb9837c8de6651e92389456adfa\n")),(0,r.kt)("p",null,"5) Set HTTP headers"),(0,r.kt)("p",null,"API requests require the signature information to be passed through HTTP headers, which must include the following four parameters"),(0,r.kt)("p",null,"X-Signature Signature value."),(0,r.kt)("p",null,"X-Timestamp Timestamp, within five minutes."),(0,r.kt)("p",null,"X-Nonce Random string."),(0,r.kt)("p",null,"X-Access-Key-Id AccessKeyId of the console account."),(0,r.kt)("h2",{id:"3-example"},"3. Example"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-go"},'package main\n\nimport (\n    "fmt"\n    "github.com/uSpeedo/usms-sdk-go/private/utils"\n    "time"\n\n    "github.com/uSpeedo/usms-sdk-go/services/usms"\n    "github.com/uSpeedo/usms-sdk-go/um"\n    "github.com/uSpeedo/usms-sdk-go/um/auth"\n    "github.com/uSpeedo/usms-sdk-go/um/config"\n    "github.com/uSpeedo/usms-sdk-go/um/log"\n)\n\nfunc main() {\n    cfg := config.NewConfig()\n    cfg.LogLevel = log.DebugLevel\n\n    credential := auth.NewCredential()\n    credential.AccessKeyId = "..."\n    credential.AccessKeySecret = "..."\n\n    client := usms.NewClient(&cfg, &credential)\n\n    // send request\n    req := client.NewSendBatchUSMSMessageRequest()\n    req.AccountId = um.Int(1)\n    req.Action = um.String("SendBatchUSMSMessage")\n    req.Target = &usms.SendBatchInfo{\n        TemplateId: "...",\n        Targets: []usms.SendBatchTarget{\n            {TemplateParams: []string{"1311"}, Phone: "138xxxx1123"},\n        },\n    }\n    //add header\n    req.SetNonce(utils.RandStr(10))\n    req.SetAccessKeyId(credential.AccessKeyId)\n    req.SetSignature(credential.CreateSign(makeSendParamMap(req)))\n    t, _ := time.ParseDuration("-2m")\n    req.SetTimestamp(time.Now().Add(t).Unix())\n    resp, err := client.SendBatchUSMSMessage(req)\n    if err != nil {\n        panic(err)\n    }\n    fmt.Printf("%+v", resp)\n}\n\nfunc makeSendParamMap(req *usms.SendBatchUSMSMessageRequest) map[string]interface{} {\n    m := make(map[string]interface{}, 0)\n    m["AccountId"] = req.AccountId\n    m["Target"] = req.Target\n    m["Action"] = req.Action\n    return m\n}\n')))}d.isMDXComponent=!0}}]);